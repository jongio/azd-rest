<!DOCTYPE html><html lang="en" class="dark" data-astro-cid-dmqsi53g> <head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="description" content="Comprehensive security architecture of azd rest ‚Äî SSRF protection, rate limiting, token security, and more"><link rel="icon" type="image/svg+xml" href="/azd-rest/favicon.svg"><link rel="preconnect" href="https://fonts.googleapis.com"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet"><title>Security | azd rest</title><!-- Open Graph --><meta property="og:type" content="website"><meta property="og:title" content="Security | azd rest"><meta property="og:description" content="Comprehensive security architecture of azd rest ‚Äî SSRF protection, rate limiting, token security, and more"><meta property="og:image" content="https://jongio.github.io/azd-rest/og-image.png"><meta property="og:url" content="https://jongio.github.io/azd-rest"><meta property="og:site_name" content="azd rest"><!-- Twitter Card --><meta name="twitter:card" content="summary_large_image"><meta name="twitter:title" content="Security | azd rest"><meta name="twitter:description" content="Comprehensive security architecture of azd rest ‚Äî SSRF protection, rate limiting, token security, and more"><meta name="twitter:image" content="https://jongio.github.io/azd-rest/og-image.png"><script>
      (function() {
        const stored = localStorage.getItem('azd-rest-theme');
        if (stored === 'light') {
          document.documentElement.classList.remove('dark');
          document.documentElement.classList.add('light');
        }
      })();
    </script><link rel="stylesheet" href="/azd-rest/_astro/examples.CQM9athF.css">
<style>.page-container[data-astro-cid-rpovodi2]{max-width:900px;margin:0 auto;padding:2rem 1.5rem}.page-header[data-astro-cid-rpovodi2]{margin-bottom:3rem;text-align:center}.page-header[data-astro-cid-rpovodi2] h1[data-astro-cid-rpovodi2]{font-size:2.5rem;font-weight:700;margin:0 0 1rem;color:var(--color-text-primary)}.page-intro[data-astro-cid-rpovodi2]{font-size:1.125rem;color:var(--color-text-secondary);max-width:640px;margin:0 auto}.content[data-astro-cid-rpovodi2]{max-width:900px}.section[data-astro-cid-rpovodi2]{margin-bottom:3rem}.section[data-astro-cid-rpovodi2] h2[data-astro-cid-rpovodi2]{font-size:1.75rem;font-weight:600;margin:0 0 1rem;color:var(--color-text-primary)}.section[data-astro-cid-rpovodi2] h3[data-astro-cid-rpovodi2]{font-size:1.25rem;font-weight:600;margin:1.5rem 0 1rem;color:var(--color-text-primary)}.section[data-astro-cid-rpovodi2] p[data-astro-cid-rpovodi2]{color:var(--color-text-secondary);line-height:1.7;margin:0 0 1rem}.section[data-astro-cid-rpovodi2] ul[data-astro-cid-rpovodi2]{color:var(--color-text-secondary);line-height:1.7;margin:0 0 1rem;padding-left:1.5rem}.section[data-astro-cid-rpovodi2] li[data-astro-cid-rpovodi2]{margin-bottom:.5rem}.security-grid[data-astro-cid-rpovodi2]{display:grid;gap:1rem;grid-template-columns:1fr;margin:1.5rem 0}@media(min-width:640px){.security-grid[data-astro-cid-rpovodi2]{grid-template-columns:repeat(2,1fr)}}@media(min-width:900px){.security-grid[data-astro-cid-rpovodi2]{grid-template-columns:repeat(3,1fr)}}.security-card[data-astro-cid-rpovodi2]{padding:1.25rem;border-radius:.75rem;background:var(--color-bg-secondary, rgba(15, 23, 42, .5));border:1px solid var(--color-border-default, rgba(255, 255, 255, .08));transition:border-color .2s ease}.security-card[data-astro-cid-rpovodi2]:hover{border-color:#06b6d44d}.card-icon[data-astro-cid-rpovodi2]{font-size:1.5rem;display:block;margin-bottom:.5rem}.security-card[data-astro-cid-rpovodi2] h4[data-astro-cid-rpovodi2]{font-size:1rem;font-weight:600;margin:0 0 .5rem;color:var(--color-text-primary)}.security-card[data-astro-cid-rpovodi2] p[data-astro-cid-rpovodi2]{font-size:.875rem;line-height:1.5;color:var(--color-text-secondary);margin:0}.comparison-table[data-astro-cid-rpovodi2]{overflow-x:auto;margin:1rem 0}.comparison-table[data-astro-cid-rpovodi2] table[data-astro-cid-rpovodi2]{width:100%;border-collapse:collapse;font-size:.9375rem}.comparison-table[data-astro-cid-rpovodi2] th[data-astro-cid-rpovodi2],.comparison-table[data-astro-cid-rpovodi2] td[data-astro-cid-rpovodi2]{text-align:left;padding:.75rem 1rem;border-bottom:1px solid var(--color-border-default, rgba(255, 255, 255, .08));color:var(--color-text-secondary)}.comparison-table[data-astro-cid-rpovodi2] th[data-astro-cid-rpovodi2]{font-weight:600;color:var(--color-text-primary);background:var(--color-bg-secondary, rgba(15, 23, 42, .5))}.comparison-table[data-astro-cid-rpovodi2] tbody[data-astro-cid-rpovodi2] tr[data-astro-cid-rpovodi2]:hover{background:var(--color-bg-secondary, rgba(15, 23, 42, .3))}.alert-warning[data-astro-cid-rpovodi2]{background-color:#fff3cd;border:2px solid #ffc107;border-radius:.5rem;padding:1rem 1.5rem;margin:1.5rem 0;color:#664d03}.dark[data-astro-cid-rpovodi2] .alert-warning[data-astro-cid-rpovodi2]{background-color:#664d03;border-color:#997404;color:#ffeaa7}
.code-block-wrapper[data-astro-cid-jgrc2lfe]{margin:1.5rem 0}
</style></head> <body data-astro-cid-dmqsi53g> <div class="animated-bg" aria-hidden="true" data-astro-cid-5a2bynky> <div class="orb orb-blue" data-astro-cid-5a2bynky></div> <div class="orb orb-indigo" data-astro-cid-5a2bynky></div> <div class="orb orb-sky" data-astro-cid-5a2bynky></div> <div class="floating-dot dot-1" data-astro-cid-5a2bynky></div> <div class="floating-dot dot-2" data-astro-cid-5a2bynky></div> <div class="floating-dot dot-3" data-astro-cid-5a2bynky></div> </div>  <div class="page-wrapper" data-astro-cid-dmqsi53g> <header class="glass-strong header" data-astro-cid-dmqsi53g> <div class="header-container" data-astro-cid-dmqsi53g> <div class="logo-group" data-astro-cid-dmqsi53g> <a href="/azd-rest/" class="logo-icon-wrapper" data-astro-cid-dmqsi53g> <svg width="18" height="18" viewBox="0 0 32 32" fill="none" stroke="white" stroke-width="2.8" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true" data-astro-cid-dmqsi53g> <polyline points="12,9 7,16 12,23" data-astro-cid-dmqsi53g></polyline> <polyline points="20,9 25,16 20,23" data-astro-cid-dmqsi53g></polyline> <line x1="18.5" y1="7.5" x2="13.5" y2="24.5" data-astro-cid-dmqsi53g></line> </svg> </a> <span class="logo-text" data-astro-cid-dmqsi53g> <span class="logo-full" data-astro-cid-dmqsi53g>azd rest</span> <span class="logo-short" data-astro-cid-dmqsi53g>azd rest</span> <span class="logo-by" data-astro-cid-dmqsi53g> by </span> <a href="https://github.com/jongio" target="_blank" rel="noopener noreferrer" class="logo-author text-gradient" data-astro-cid-dmqsi53g>Jon Gallant</a> </span> </div> <div class="header-actions" data-astro-cid-dmqsi53g> <a href="/azd-rest/getting-started/" class="nav-link" data-astro-cid-dmqsi53g>Getting Started</a><a href="/azd-rest/examples/" class="nav-link" data-astro-cid-dmqsi53g>Examples</a><a href="/azd-rest/reference/cli/" class="nav-link" data-astro-cid-dmqsi53g>CLI Reference</a><a href="/azd-rest/security/" class="nav-link active" data-astro-cid-dmqsi53g>Security</a> <button class="theme-toggle" id="theme-toggle" aria-label="Toggle theme" data-astro-cid-dmqsi53g> <svg class="sun-icon" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" data-astro-cid-dmqsi53g> <circle cx="12" cy="12" r="4" data-astro-cid-dmqsi53g></circle><path d="M12 2v2" data-astro-cid-dmqsi53g></path><path d="M12 20v2" data-astro-cid-dmqsi53g></path><path d="m4.93 4.93 1.41 1.41" data-astro-cid-dmqsi53g></path><path d="m17.66 17.66 1.41 1.41" data-astro-cid-dmqsi53g></path><path d="M2 12h2" data-astro-cid-dmqsi53g></path><path d="M20 12h2" data-astro-cid-dmqsi53g></path><path d="m6.34 17.66-1.41 1.41" data-astro-cid-dmqsi53g></path><path d="m19.07 4.93-1.41 1.41" data-astro-cid-dmqsi53g></path> </svg> <svg class="moon-icon" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" data-astro-cid-dmqsi53g> <path d="M12 3a6 6 0 0 0 9 9 9 9 0 1 1-9-9Z" data-astro-cid-dmqsi53g></path> </svg> </button> <a href="https://x.com/jongallant" target="_blank" rel="noopener noreferrer" aria-label="Jon Gallant on X" class="social-link" data-astro-cid-dmqsi53g> <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-astro-cid-dmqsi53g> <path d="M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z" data-astro-cid-dmqsi53g></path> </svg> </a> <a href="https://github.com/jongio/azd-rest" class="github-link glass" target="_blank" rel="noopener" data-astro-cid-dmqsi53g> <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-astro-cid-dmqsi53g> <path d="M12 2C6.477 2 2 6.477 2 12c0 4.42 2.865 8.164 6.839 9.49.5.09.682-.218.682-.484 0-.237-.009-.866-.013-1.7-2.782.603-3.369-1.34-3.369-1.34-.454-1.156-1.11-1.463-1.11-1.463-.908-.62.069-.608.069-.608 1.003.07 1.531 1.03 1.531 1.03.892 1.529 2.341 1.088 2.91.832.092-.647.35-1.088.636-1.338-2.22-.253-4.555-1.11-4.555-4.943 0-1.091.39-1.984 1.029-2.683-.103-.253-.446-1.27.098-2.647 0 0 .84-.268 2.75 1.026A9.578 9.578 0 0112 6.836c.85.004 1.705.114 2.504.336 1.909-1.294 2.747-1.026 2.747-1.026.546 1.377.203 2.394.1 2.647.64.699 1.028 1.592 1.028 2.683 0 3.842-2.339 4.687-4.566 4.935.359.309.678.919.678 1.852 0 1.336-.012 2.415-.012 2.743 0 .269.18.579.688.481C19.138 20.161 22 16.418 22 12c0-5.523-4.477-10-10-10z" data-astro-cid-dmqsi53g></path> </svg> <span class="github-text" data-astro-cid-dmqsi53g>jongio</span> </a> <button class="mobile-menu-btn" id="mobile-menu-toggle" aria-label="Toggle menu" aria-expanded="false" data-astro-cid-dmqsi53g> <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" data-astro-cid-dmqsi53g> <line x1="3" y1="12" x2="21" y2="12" data-astro-cid-dmqsi53g></line> <line x1="3" y1="6" x2="21" y2="6" data-astro-cid-dmqsi53g></line> <line x1="3" y1="18" x2="21" y2="18" data-astro-cid-dmqsi53g></line> </svg> </button> </div> </div> <nav class="mobile-nav" id="mobile-menu" data-astro-cid-dmqsi53g> <a href="/azd-rest/getting-started/" class="mobile-nav-link" data-astro-cid-dmqsi53g>Getting Started</a><a href="/azd-rest/examples/" class="mobile-nav-link" data-astro-cid-dmqsi53g>Examples</a><a href="/azd-rest/reference/cli/" class="mobile-nav-link" data-astro-cid-dmqsi53g>CLI Reference</a><a href="/azd-rest/security/" class="mobile-nav-link active" data-astro-cid-dmqsi53g>Security</a> </nav> </header> <main class="main" data-astro-cid-dmqsi53g>  <div class="page-container" data-astro-cid-rpovodi2> <div class="page-header" data-astro-cid-rpovodi2> <h1 data-astro-cid-rpovodi2>Security Architecture</h1> <p class="page-intro" data-astro-cid-rpovodi2>
azd rest is built with defense-in-depth security. Every layer ‚Äî from network access to token handling ‚Äî is
        hardened by default with zero-trust principles.
</p> </div> <div class="content" data-astro-cid-rpovodi2> <!-- At a Glance --> <section class="section" data-astro-cid-rpovodi2> <h2 data-astro-cid-rpovodi2>At a Glance</h2> <div class="security-grid" data-astro-cid-rpovodi2> <div class="security-card" data-astro-cid-rpovodi2> <span class="card-icon" data-astro-cid-rpovodi2>üõ°Ô∏è</span> <h4 data-astro-cid-rpovodi2>SSRF Protection</h4> <p data-astro-cid-rpovodi2>Blocks cloud metadata endpoints, private IPs, and loopback addresses with DNS resolution validation.</p> </div> <div class="security-card" data-astro-cid-rpovodi2> <span class="card-icon" data-astro-cid-rpovodi2>‚è±Ô∏è</span> <h4 data-astro-cid-rpovodi2>Rate Limiting</h4> <p data-astro-cid-rpovodi2>Token bucket algorithm limits MCP requests to 10 burst / 1 per second sustained.</p> </div> <div class="security-card" data-astro-cid-rpovodi2> <span class="card-icon" data-astro-cid-rpovodi2>üîê</span> <h4 data-astro-cid-rpovodi2>Token Security</h4> <p data-astro-cid-rpovodi2>Tokens are never logged, automatically redacted, and short-lived with scope isolation.</p> </div> <div class="security-card" data-astro-cid-rpovodi2> <span class="card-icon" data-astro-cid-rpovodi2>üö´</span> <h4 data-astro-cid-rpovodi2>Header Blocklist</h4> <p data-astro-cid-rpovodi2>Prevents MCP clients from injecting Authorization, Host, Cookie, or Proxy-Authorization headers.</p> </div> <div class="security-card" data-astro-cid-rpovodi2> <span class="card-icon" data-astro-cid-rpovodi2>üìè</span> <h4 data-astro-cid-rpovodi2>Response Limits</h4> <p data-astro-cid-rpovodi2>10 MB response cap for MCP server, 100 MB for CLI ‚Äî prevents memory exhaustion attacks.</p> </div> <div class="security-card" data-astro-cid-rpovodi2> <span class="card-icon" data-astro-cid-rpovodi2>üîó</span> <h4 data-astro-cid-rpovodi2>Scope Validation</h4> <p data-astro-cid-rpovodi2>Validates that OAuth scope domains match request URL domains to prevent token exfiltration.</p> </div> </div> </section> <!-- SSRF Protection --> <section class="section" data-astro-cid-rpovodi2> <h2 data-astro-cid-rpovodi2>SSRF Protection</h2> <p data-astro-cid-rpovodi2>
The MCP server implements comprehensive Server-Side Request Forgery (SSRF) protection to prevent
          AI agents from accessing internal infrastructure through azd rest.
</p> <h3 data-astro-cid-rpovodi2>Cloud Metadata Endpoint Blocklist</h3> <p data-astro-cid-rpovodi2>Requests to cloud provider metadata services are unconditionally blocked:</p> <div class="code-block-wrapper" data-astro-cid-jgrc2lfe> <div class="expressive-code"><link rel="stylesheet" href="/azd-rest/_astro/ec.y0rd3.css"><script type="module" src="/azd-rest/_astro/ec.0vx5m.js"></script><figure class="frame"><figcaption class="header"></figcaption><pre data-language="text"><code><div class="ec-line"><div class="code"><span style="--0:#e1e4e8;--1:#24292e">// Blocked metadata endpoints</span></div></div><div class="ec-line"><div class="code"><span style="--0:#e1e4e8;--1:#24292e">169.254.169.254      // AWS, Azure IMDS</span></div></div><div class="ec-line"><div class="code"><span style="--0:#e1e4e8;--1:#24292e">fd00:ec2::254       // AWS IPv6 IMDS</span></div></div><div class="ec-line"><div class="code"><span style="--0:#e1e4e8;--1:#24292e">metadata.google.internal  // GCP metadata</span></div></div><div class="ec-line"><div class="code"><span style="--0:#e1e4e8;--1:#24292e">100.100.100.200     // Alibaba Cloud metadata</span></div></div></code></pre><div class="copy"><div aria-live="polite"></div><button title="Copy to clipboard" data-copied="Copied!" data-code="// Blocked metadata endpoints169.254.169.254      // AWS, Azure IMDSfd00:ec2::254       // AWS IPv6 IMDSmetadata.google.internal  // GCP metadata100.100.100.200     // Alibaba Cloud metadata"><div></div></button></div></figure></div> </div>  <h3 data-astro-cid-rpovodi2>Private Network CIDR Blocking</h3> <p data-astro-cid-rpovodi2>All private and loopback IP ranges are blocked to prevent internal network access:</p> <div class="code-block-wrapper" data-astro-cid-jgrc2lfe> <div class="expressive-code"><figure class="frame"><figcaption class="header"></figcaption><pre data-language="text"><code><div class="ec-line"><div class="code"><span style="--0:#e1e4e8;--1:#24292e">// Blocked CIDR ranges</span></div></div><div class="ec-line"><div class="code"><span style="--0:#e1e4e8;--1:#24292e">127.0.0.0/8      // IPv4 loopback</span></div></div><div class="ec-line"><div class="code"><span style="--0:#e1e4e8;--1:#24292e">::1/128          // IPv6 loopback</span></div></div><div class="ec-line"><div class="code"><span style="--0:#e1e4e8;--1:#24292e">169.254.0.0/16   // IPv4 link-local</span></div></div><div class="ec-line"><div class="code"><span style="--0:#e1e4e8;--1:#24292e">fe80::/10        // IPv6 link-local</span></div></div><div class="ec-line"><div class="code"><span style="--0:#e1e4e8;--1:#24292e">10.0.0.0/8       // RFC 1918 private</span></div></div><div class="ec-line"><div class="code"><span style="--0:#e1e4e8;--1:#24292e">172.16.0.0/12    // RFC 1918 private</span></div></div><div class="ec-line"><div class="code"><span style="--0:#e1e4e8;--1:#24292e">192.168.0.0/16   // RFC 1918 private</span></div></div></code></pre><div class="copy"><div aria-live="polite"></div><button title="Copy to clipboard" data-copied="Copied!" data-code="// Blocked CIDR ranges127.0.0.0/8      // IPv4 loopback::1/128          // IPv6 loopback169.254.0.0/16   // IPv4 link-localfe80::/10        // IPv6 link-local10.0.0.0/8       // RFC 1918 private172.16.0.0/12    // RFC 1918 private192.168.0.0/16   // RFC 1918 private"><div></div></button></div></figure></div> </div>  <h3 data-astro-cid-rpovodi2>DNS Resolution Validation</h3> <p data-astro-cid-rpovodi2>
Hostnames are resolved to IP addresses <strong data-astro-cid-rpovodi2>before</strong> the request is sent. This prevents
          bypass via DNS names that resolve to blocked addresses (e.g., a hostname that resolves to
<code data-astro-cid-rpovodi2>169.254.169.254</code>). If DNS resolution fails, the request is blocked by default.
</p> <ul data-astro-cid-rpovodi2> <li data-astro-cid-rpovodi2>‚úÖ Resolves hostnames to IPs and checks each resolved address against blocklists</li> <li data-astro-cid-rpovodi2>‚úÖ Blocks hex/octal/decimal IP representation bypasses</li> <li data-astro-cid-rpovodi2>‚úÖ Fails closed ‚Äî DNS resolution errors result in blocked requests</li> </ul> </section> <!-- Rate Limiting --> <section class="section" data-astro-cid-rpovodi2> <h2 data-astro-cid-rpovodi2>Rate Limiting</h2> <p data-astro-cid-rpovodi2>
The MCP server uses a token bucket algorithm to prevent runaway AI agents from flooding Azure
          APIs with requests.
</p> <ul data-astro-cid-rpovodi2> <li data-astro-cid-rpovodi2><strong data-astro-cid-rpovodi2>Burst capacity:</strong> 10 requests</li> <li data-astro-cid-rpovodi2><strong data-astro-cid-rpovodi2>Sustained rate:</strong> 1 request per second (~60 per minute)</li> <li data-astro-cid-rpovodi2><strong data-astro-cid-rpovodi2>Scope:</strong> Applied per MCP server instance</li> </ul> <p data-astro-cid-rpovodi2>
When the rate limit is exceeded, the MCP tool returns a clear error message rather than
          silently queuing or dropping requests.
</p> </section> <!-- Authentication Security --> <section class="section" data-astro-cid-rpovodi2> <h2 data-astro-cid-rpovodi2>Authentication Security</h2> <h3 data-astro-cid-rpovodi2>Automatic Scope Detection</h3> <p data-astro-cid-rpovodi2>
azd rest automatically detects the correct OAuth scope for 20+ Azure services based on the
          request URL. This ensures each request uses the minimum required permissions ‚Äî no over-scoped
          tokens.
</p> <h3 data-astro-cid-rpovodi2>Scope / URL Validation</h3> <p data-astro-cid-rpovodi2>
When a custom scope override is provided, azd rest validates that the scope domain matches
          the request URL domain. This prevents an attacker from tricking the tool into sending a token
          scoped for one service to a different endpoint.
</p> <ul data-astro-cid-rpovodi2> <li data-astro-cid-rpovodi2>‚úÖ Scope host must match request URL host (or be a parent domain)</li> <li data-astro-cid-rpovodi2>‚úÖ Single-label scope hosts (bare TLDs like <code data-astro-cid-rpovodi2>com</code>) are rejected</li> <li data-astro-cid-rpovodi2>‚úÖ Both scope and URL must have valid, non-empty hostnames</li> </ul> <h3 data-astro-cid-rpovodi2>Automatic Auth Skip for HTTP</h3> <p data-astro-cid-rpovodi2>
Authentication is automatically disabled for plain HTTP URLs to prevent sending bearer tokens
          over unencrypted connections. This is enforced at the HTTP client level ‚Äî no configuration needed.
</p> <ul data-astro-cid-rpovodi2> <li data-astro-cid-rpovodi2>‚úÖ <code data-astro-cid-rpovodi2>http://</code> URLs ‚Üí auth automatically skipped (no token sent)</li> <li data-astro-cid-rpovodi2>‚úÖ Existing <code data-astro-cid-rpovodi2>Authorization</code> header ‚Üí Azure token injection skipped</li> <li data-astro-cid-rpovodi2>‚úÖ <code data-astro-cid-rpovodi2>--no-auth</code> flag ‚Üí explicit opt-out for non-Azure endpoints</li> </ul> <h3 data-astro-cid-rpovodi2>Token Caching</h3> <p data-astro-cid-rpovodi2>
Tokens are cached per scope until 2 minutes before expiry. The cache is managed by azd-core
          and supports the full Azure credential chain (Azure CLI, Managed Identity, Environment Variables).
          For the MCP server, a single cached token provider is reused across requests to avoid repeated
          credential creation.
</p> </section> <!-- Header Security --> <section class="section" data-astro-cid-rpovodi2> <h2 data-astro-cid-rpovodi2>Header Security</h2> <h3 data-astro-cid-rpovodi2>MCP Header Blocklist</h3> <p data-astro-cid-rpovodi2>
The MCP server blocks sensitive headers from being set via custom header parameters. This prevents
          AI agents from injecting credentials or routing requests to unintended hosts:
</p> <div class="code-block-wrapper" data-astro-cid-jgrc2lfe> <div class="expressive-code"><figure class="frame"><figcaption class="header"></figcaption><pre data-language="text"><code><div class="ec-line"><div class="code"><span style="--0:#e1e4e8;--1:#24292e">// Blocked headers (case-insensitive)</span></div></div><div class="ec-line"><div class="code"><span style="--0:#e1e4e8;--1:#24292e">authorization        // Prevents token injection</span></div></div><div class="ec-line"><div class="code"><span style="--0:#e1e4e8;--1:#24292e">host                 // Prevents request routing manipulation</span></div></div><div class="ec-line"><div class="code"><span style="--0:#e1e4e8;--1:#24292e">cookie               // Prevents session hijacking</span></div></div><div class="ec-line"><div class="code"><span style="--0:#e1e4e8;--1:#24292e">proxy-authorization  // Prevents proxy credential injection</span></div></div></code></pre><div class="copy"><div aria-live="polite"></div><button title="Copy to clipboard" data-copied="Copied!" data-code="// Blocked headers (case-insensitive)authorization        // Prevents token injectionhost                 // Prevents request routing manipulationcookie               // Prevents session hijackingproxy-authorization  // Prevents proxy credential injection"><div></div></button></div></figure></div> </div>  <h3 data-astro-cid-rpovodi2>Token Redaction</h3> <p data-astro-cid-rpovodi2>
In verbose mode, sensitive headers are automatically redacted. Bearer tokens show only the first
          and last 4 characters (e.g., <code data-astro-cid-rpovodi2>eyJ4...a2Bc</code>). This applies to both request and response
          headers in CLI output.
</p> </section> <!-- Response & Request Limits --> <section class="section" data-astro-cid-rpovodi2> <h2 data-astro-cid-rpovodi2>Response &amp; Request Limits</h2> <h3 data-astro-cid-rpovodi2>Response Size Limits</h3> <div class="comparison-table" data-astro-cid-rpovodi2> <table data-astro-cid-rpovodi2> <thead data-astro-cid-rpovodi2> <tr data-astro-cid-rpovodi2> <th data-astro-cid-rpovodi2>Context</th> <th data-astro-cid-rpovodi2>Limit</th> <th data-astro-cid-rpovodi2>Purpose</th> </tr> </thead> <tbody data-astro-cid-rpovodi2> <tr data-astro-cid-rpovodi2> <td data-astro-cid-rpovodi2>MCP Server</td> <td data-astro-cid-rpovodi2>10 MB</td> <td data-astro-cid-rpovodi2>Prevents memory exhaustion from AI agent requests</td> </tr> <tr data-astro-cid-rpovodi2> <td data-astro-cid-rpovodi2>CLI</td> <td data-astro-cid-rpovodi2>100 MB</td> <td data-astro-cid-rpovodi2>Handles large responses while preventing unbounded reads</td> </tr> </tbody> </table> </div> <h3 data-astro-cid-rpovodi2>Timeout Control</h3> <ul data-astro-cid-rpovodi2> <li data-astro-cid-rpovodi2><strong data-astro-cid-rpovodi2>Default:</strong> 30 seconds per request</li> <li data-astro-cid-rpovodi2><strong data-astro-cid-rpovodi2>Configurable:</strong> <code data-astro-cid-rpovodi2>--timeout</code> flag in CLI mode</li> <li data-astro-cid-rpovodi2><strong data-astro-cid-rpovodi2>MCP Server:</strong> Fixed 30-second timeout per tool call</li> </ul> <h3 data-astro-cid-rpovodi2>Redirect Control</h3> <ul data-astro-cid-rpovodi2> <li data-astro-cid-rpovodi2><strong data-astro-cid-rpovodi2>MCP Server:</strong> Redirects are <strong data-astro-cid-rpovodi2>disabled</strong> ‚Äî prevents open redirect exploitation</li> <li data-astro-cid-rpovodi2><strong data-astro-cid-rpovodi2>CLI:</strong> Redirects enabled by default, capped at 10 hops, controllable via <code data-astro-cid-rpovodi2>--follow-redirects</code> and <code data-astro-cid-rpovodi2>--max-redirects</code></li> </ul> <h3 data-astro-cid-rpovodi2>Retry with Backoff</h3> <p data-astro-cid-rpovodi2>
Configurable retry logic with exponential backoff handles transient failures and throttling
          responses (HTTP 429, 503). Default: 3 retries. This prevents cascading failures while
          respecting service rate limits.
</p> </section> <!-- TLS/HTTPS --> <section class="section" data-astro-cid-rpovodi2> <h2 data-astro-cid-rpovodi2>TLS / HTTPS</h2> <ul data-astro-cid-rpovodi2> <li data-astro-cid-rpovodi2>‚úÖ <strong data-astro-cid-rpovodi2>HTTPS by default</strong> ‚Äî all Azure endpoints use HTTPS</li> <li data-astro-cid-rpovodi2>‚úÖ <strong data-astro-cid-rpovodi2>Certificate validation</strong> ‚Äî enabled by default, validates server certificates</li> <li data-astro-cid-rpovodi2>‚úÖ <strong data-astro-cid-rpovodi2>Auth auto-skip for HTTP</strong> ‚Äî tokens are never sent over unencrypted connections</li> <li data-astro-cid-rpovodi2>‚ö†Ô∏è <strong data-astro-cid-rpovodi2><code data-astro-cid-rpovodi2>--insecure</code> flag</strong> ‚Äî disables TLS certificate validation (testing only)</li> </ul> <div class="alert-warning" data-astro-cid-rpovodi2> <strong data-astro-cid-rpovodi2>Warning:</strong> The <code data-astro-cid-rpovodi2>--insecure</code> flag disables TLS certificate validation.
          Never use this in production or with sensitive data.
</div> </section> <!-- Audit & Observability --> <section class="section" data-astro-cid-rpovodi2> <h2 data-astro-cid-rpovodi2>Audit &amp; Observability</h2> <h3 data-astro-cid-rpovodi2>OpenTelemetry Tracing</h3> <p data-astro-cid-rpovodi2>
azd rest propagates <code data-astro-cid-rpovodi2>TRACEPARENT</code> and <code data-astro-cid-rpovodi2>TRACESTATE</code> environment variables
          into the request context, enabling distributed tracing across azd ‚Üí extension ‚Üí Azure service
          call chains.
</p> <h3 data-astro-cid-rpovodi2>Telemetry Headers</h3> <p data-astro-cid-rpovodi2>Every request includes metadata-only telemetry headers for diagnostics:</p> <div class="code-block-wrapper" data-astro-cid-jgrc2lfe> <div class="expressive-code"><figure class="frame"><figcaption class="header"></figcaption><pre data-language="text"><code><div class="ec-line"><div class="code"><span style="--0:#e1e4e8;--1:#24292e">User-Agent: azd-rest/{version} (azd extension)</span></div></div><div class="ec-line"><div class="code"><span style="--0:#e1e4e8;--1:#24292e">x-ms-client-request-id: {UUID}</span></div></div><div class="ec-line"><div class="code"><span style="--0:#e1e4e8;--1:#24292e">x-ms-command-name: azd rest</span></div></div></code></pre><div class="copy"><div aria-live="polite"></div><button title="Copy to clipboard" data-copied="Copied!" data-code="User-Agent: azd-rest/{version} (azd extension)x-ms-client-request-id: {UUID}x-ms-command-name: azd rest"><div></div></button></div></figure></div> </div>  <p data-astro-cid-rpovodi2>
No tokens, request bodies, or response bodies are included in telemetry.
</p> <h3 data-astro-cid-rpovodi2>Verbose Mode</h3> <p data-astro-cid-rpovodi2>
When using <code data-astro-cid-rpovodi2>--verbose</code>, azd rest displays request method, URL, headers (with token
          redaction), response status, and timing. Request and response bodies are never logged.
</p> </section> <!-- CI Security Pipeline --> <section class="section" data-astro-cid-rpovodi2> <h2 data-astro-cid-rpovodi2>CI Security Pipeline</h2> <p data-astro-cid-rpovodi2>
Every commit to azd rest runs through a comprehensive security pipeline in GitHub Actions
          across Linux, Windows, and macOS:
</p> <ul data-astro-cid-rpovodi2> <li data-astro-cid-rpovodi2>üîç <strong data-astro-cid-rpovodi2>gosec</strong> ‚Äî static analysis for Go security vulnerabilities</li> <li data-astro-cid-rpovodi2>üîç <strong data-astro-cid-rpovodi2>govulncheck</strong> ‚Äî checks dependencies against the Go vulnerability database</li> <li data-astro-cid-rpovodi2>üîç <strong data-astro-cid-rpovodi2>golangci-lint</strong> ‚Äî runs 15+ linters including security-focused checks</li> <li data-astro-cid-rpovodi2>üîç <strong data-astro-cid-rpovodi2>go vet</strong> ‚Äî catches common coding mistakes</li> <li data-astro-cid-rpovodi2>üìä <strong data-astro-cid-rpovodi2>Test coverage</strong> ‚Äî enforced minimum coverage with comprehensive test suite</li> <li data-astro-cid-rpovodi2>üìù <strong data-astro-cid-rpovodi2>cspell</strong> ‚Äî catches typos that could mask security issues</li> </ul> </section> <!-- Threat Model --> <section class="section" data-astro-cid-rpovodi2> <h2 data-astro-cid-rpovodi2>Threat Model</h2> <h3 data-astro-cid-rpovodi2>Assets Protected</h3> <ul data-astro-cid-rpovodi2> <li data-astro-cid-rpovodi2><strong data-astro-cid-rpovodi2>Azure authentication tokens</strong> ‚Äî short-lived, scope-isolated, never logged</li> <li data-astro-cid-rpovodi2><strong data-astro-cid-rpovodi2>Request / response bodies</strong> ‚Äî may contain sensitive data, never included in telemetry</li> <li data-astro-cid-rpovodi2><strong data-astro-cid-rpovodi2>Internal infrastructure</strong> ‚Äî protected by SSRF blocklists and CIDR filtering</li> <li data-astro-cid-rpovodi2><strong data-astro-cid-rpovodi2>Cloud metadata services</strong> ‚Äî unconditionally blocked</li> </ul> <h3 data-astro-cid-rpovodi2>Threats &amp; Mitigations</h3> <div class="comparison-table" data-astro-cid-rpovodi2> <table data-astro-cid-rpovodi2> <thead data-astro-cid-rpovodi2> <tr data-astro-cid-rpovodi2> <th data-astro-cid-rpovodi2>Threat</th> <th data-astro-cid-rpovodi2>Mitigation</th> </tr> </thead> <tbody data-astro-cid-rpovodi2> <tr data-astro-cid-rpovodi2> <td data-astro-cid-rpovodi2>SSRF via MCP agent</td> <td data-astro-cid-rpovodi2>Blocked hosts, CIDR ranges, DNS resolution validation</td> </tr> <tr data-astro-cid-rpovodi2> <td data-astro-cid-rpovodi2>Token exfiltration</td> <td data-astro-cid-rpovodi2>Scope/URL validation, header blocklist, HTTP auto-skip</td> </tr> <tr data-astro-cid-rpovodi2> <td data-astro-cid-rpovodi2>Token leakage in logs</td> <td data-astro-cid-rpovodi2>Automatic redaction in verbose mode, tokens never logged</td> </tr> <tr data-astro-cid-rpovodi2> <td data-astro-cid-rpovodi2>Man-in-the-middle</td> <td data-astro-cid-rpovodi2>HTTPS enforcement, TLS certificate validation</td> </tr> <tr data-astro-cid-rpovodi2> <td data-astro-cid-rpovodi2>Credential injection</td> <td data-astro-cid-rpovodi2>Authorization, Cookie, Proxy-Authorization header blocklist</td> </tr> <tr data-astro-cid-rpovodi2> <td data-astro-cid-rpovodi2>Resource exhaustion</td> <td data-astro-cid-rpovodi2>Rate limiting, response size limits, request timeouts</td> </tr> <tr data-astro-cid-rpovodi2> <td data-astro-cid-rpovodi2>Open redirect abuse</td> <td data-astro-cid-rpovodi2>Redirects disabled in MCP server, capped at 10 in CLI</td> </tr> <tr data-astro-cid-rpovodi2> <td data-astro-cid-rpovodi2>Dependency vulnerabilities</td> <td data-astro-cid-rpovodi2>govulncheck + gosec in CI pipeline on every commit</td> </tr> </tbody> </table> </div> </section> <!-- Best Practices --> <section class="section" data-astro-cid-rpovodi2> <h2 data-astro-cid-rpovodi2>Best Practices</h2> <h3 data-astro-cid-rpovodi2>‚úÖ Recommended</h3> <ul data-astro-cid-rpovodi2> <li data-astro-cid-rpovodi2>Use HTTPS for all requests (default behavior)</li> <li data-astro-cid-rpovodi2>Let scope auto-detection choose the correct OAuth scope</li> <li data-astro-cid-rpovodi2>Review URLs before executing requests, especially in scripts</li> <li data-astro-cid-rpovodi2>Store sensitive data in Azure Key Vault, not in request bodies</li> <li data-astro-cid-rpovodi2>Use <code data-astro-cid-rpovodi2>--verbose</code> for debugging only (tokens are redacted but visible metadata increases surface area)</li> </ul> <h3 data-astro-cid-rpovodi2>‚ùå Avoid</h3> <ul data-astro-cid-rpovodi2> <li data-astro-cid-rpovodi2>Don't use <code data-astro-cid-rpovodi2>--insecure</code> in production</li> <li data-astro-cid-rpovodi2>Don't pipe untrusted URLs to azd rest</li> <li data-astro-cid-rpovodi2>Don't override scopes without understanding the token scope implications</li> <li data-astro-cid-rpovodi2>Don't use HTTP endpoints for anything with sensitive data</li> </ul> </section> <!-- Reporting --> <section class="section" data-astro-cid-rpovodi2> <h2 data-astro-cid-rpovodi2>Reporting Security Issues</h2> <p data-astro-cid-rpovodi2>
If you discover a security vulnerability, please report it responsibly:
</p> <ul data-astro-cid-rpovodi2> <li data-astro-cid-rpovodi2>üîí Use <a href="https://github.com/jongio/azd-rest/security/advisories" target="_blank" rel="noopener noreferrer" data-astro-cid-rpovodi2>GitHub Security Advisories</a> for responsible disclosure</li> <li data-astro-cid-rpovodi2>üìã Include steps to reproduce and potential impact</li> </ul> <p data-astro-cid-rpovodi2> <strong data-astro-cid-rpovodi2>Do not</strong> open public issues for security vulnerabilities.
</p> </section> </div> </div>  </main> <footer class="footer" data-astro-cid-dmqsi53g> <div class="footer-container" data-astro-cid-dmqsi53g> <div class="footer-content" data-astro-cid-dmqsi53g> <p class="footer-love" data-astro-cid-dmqsi53g>
Built with
<svg width="16" height="16" viewBox="0 0 24 24" fill="var(--color-glow-violet)" stroke="none" class="heart-icon" aria-label="love" data-astro-cid-dmqsi53g> <path d="M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z" data-astro-cid-dmqsi53g></path> </svg>
by <a href="https://github.com/jongio" target="_blank" rel="noopener" data-astro-cid-dmqsi53g>Jon Gallant</a> </p> <div class="footer-links" data-astro-cid-dmqsi53g> <a href="https://learn.microsoft.com/azure/developer/azure-developer-cli/overview" target="_blank" rel="noopener" data-astro-cid-dmqsi53g>Azure Developer CLI</a> <a href="https://github.com/jongio/azd-rest" target="_blank" rel="noopener" data-astro-cid-dmqsi53g> <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-astro-cid-dmqsi53g> <path d="M12 2C6.477 2 2 6.477 2 12c0 4.42 2.865 8.164 6.839 9.49.5.09.682-.218.682-.484 0-.237-.009-.866-.013-1.7-2.782.603-3.369-1.34-3.369-1.34-.454-1.156-1.11-1.463-1.11-1.463-.908-.62.069-.608.069-.608 1.003.07 1.531 1.03 1.531 1.03.892 1.529 2.341 1.088 2.91.832.092-.647.35-1.088.636-1.338-2.22-.253-4.555-1.11-4.555-4.943 0-1.091.39-1.984 1.029-2.683-.103-.253-.446-1.27.098-2.647 0 0 .84-.268 2.75 1.026A9.578 9.578 0 0112 6.836c.85.004 1.705.114 2.504.336 1.909-1.294 2.747-1.026 2.747-1.026.546 1.377.203 2.394.1 2.647.64.699 1.028 1.592 1.028 2.683 0 3.842-2.339 4.687-4.566 4.935.359.309.678.919.678 1.852 0 1.336-.012 2.415-.012 2.743 0 .269.18.579.688.481C19.138 20.161 22 16.418 22 12c0-5.523-4.477-10-10-10z" data-astro-cid-dmqsi53g></path> </svg>
Source
</a> </div> </div> </div> </footer> </div>   <script type="module">const o=document.getElementById("theme-toggle");o&&o.addEventListener("click",()=>{const e=document.documentElement,s=e.classList.contains("dark");e.classList.remove("dark","light"),e.classList.add(s?"light":"dark"),localStorage.setItem("azd-rest-theme",s?"light":"dark")});const t=document.getElementById("mobile-menu-toggle"),n=document.getElementById("mobile-menu");t&&n&&t.addEventListener("click",()=>{const e=n.classList.contains("open");n.classList.toggle("open"),t.setAttribute("aria-expanded",String(!e))});</script></body></html> 