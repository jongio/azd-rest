---
import Layout from '../components/Layout.astro';
import CodeBlock from '../components/CodeBlock.astro';

const base = import.meta.env.BASE_URL;
---

<Layout title="Examples" description="Real-world examples of using azd rest for Azure REST API calls">
  <div class="page-container">
    <div class="page-header">
      <h1>Examples</h1>
      <p class="page-intro">
        Learn how to use azd rest in real-world scenarios with these practical examples.
      </p>
    </div>

    <div class="content">
      <section class="example">
        <div class="example-header">
          <h2>üìã List Azure Subscriptions</h2>
          <p>The simplest API call ‚Äî list all subscriptions available to your account.</p>
        </div>

        <CodeBlock code={`azd rest get https://management.azure.com/subscriptions?api-version=2020-01-01`} language="bash" />

        <p>With pagination to get all results:</p>
        <CodeBlock code={`azd rest get https://management.azure.com/subscriptions?api-version=2020-01-01 --paginate`} language="bash" />
      </section>

      <section class="example">
        <div class="example-header">
          <h2>üóÇÔ∏è Manage Resource Groups</h2>
          <p>Create, list, and manage Azure resource groups.</p>
        </div>

        <h3>List Resource Groups</h3>
        <CodeBlock code={`azd rest get https://management.azure.com/subscriptions/{subscriptionId}/resourcegroups?api-version=2021-04-01`} language="bash" />

        <h3>Create a Resource Group</h3>
        <CodeBlock code={`azd rest put https://management.azure.com/subscriptions/{subscriptionId}/resourcegroups/my-rg?api-version=2021-04-01 \\
  --data '{"location":"eastus","tags":{"environment":"dev"}}'`} language="bash" />

        <h3>Delete a Resource Group</h3>
        <CodeBlock code={`azd rest delete https://management.azure.com/subscriptions/{subscriptionId}/resourcegroups/my-rg?api-version=2021-04-01`} language="bash" />
      </section>

      <section class="example">
        <div class="example-header">
          <h2>üíæ Create a Storage Account</h2>
          <p>Provision Azure Storage with a POST request and JSON body.</p>
        </div>

        <h3>Inline JSON</h3>
        <CodeBlock code={`azd rest put https://management.azure.com/subscriptions/{sub}/resourceGroups/{rg}/providers/Microsoft.Storage/storageAccounts/{name}?api-version=2021-04-01 \\
  --data '{"location":"eastus","kind":"StorageV2","sku":{"name":"Standard_LRS"}}'`} language="bash" />

        <h3>From File</h3>
        <CodeBlock code={`# storage-account.json
# {"location":"eastus","kind":"StorageV2","sku":{"name":"Standard_LRS"}}

azd rest put https://management.azure.com/subscriptions/{sub}/resourceGroups/{rg}/providers/Microsoft.Storage/storageAccounts/{name}?api-version=2021-04-01 \\
  --data-file storage-account.json`} language="bash" />
      </section>

      <section class="example" id="keyvault">
        <div class="example-header">
          <h2>üîê Key Vault Secrets</h2>
          <p>Read and manage secrets in Azure Key Vault ‚Äî scope is auto-detected.</p>
        </div>

        <h3>Get a Secret</h3>
        <CodeBlock code={`azd rest get https://myvault.vault.azure.net/secrets/mysecret?api-version=7.4`} language="bash" />

        <h3>List All Secrets</h3>
        <CodeBlock code={`azd rest get https://myvault.vault.azure.net/secrets?api-version=7.4`} language="bash" />

        <h3>Set a Secret</h3>
        <CodeBlock code={`azd rest put https://myvault.vault.azure.net/secrets/newsecret?api-version=7.4 \\
  --data '{"value":"my-secret-value"}'`} language="bash" />
      </section>

      <section class="example">
        <div class="example-header">
          <h2>üë§ Microsoft Graph</h2>
          <p>Query Microsoft Graph API for user and organization data.</p>
        </div>

        <h3>Get Current User</h3>
        <CodeBlock code={`azd rest get https://graph.microsoft.com/v1.0/me`} language="bash" />

        <h3>List Groups</h3>
        <CodeBlock code={`azd rest get https://graph.microsoft.com/v1.0/groups`} language="bash" />

        <h3>List Applications</h3>
        <CodeBlock code={`azd rest get https://graph.microsoft.com/v1.0/applications`} language="bash" />
      </section>

      <section class="example">
        <div class="example-header">
          <h2>üìä Verbose Diagnostics</h2>
          <p>Debug requests with verbose output showing headers, timing, and token info (redacted).</p>
        </div>

        <CodeBlock code={`azd rest get https://management.azure.com/subscriptions?api-version=2020-01-01 --verbose`} language="bash" />

        <p>Example output:</p>
        <CodeBlock code={`> GET https://management.azure.com/subscriptions?api-version=2020-01-01
> Authorization: Bearer ***REDACTED***
> Accept: application/json
>
< 200 OK
< Content-Type: application/json
< Content-Length: 1234
<
Request completed in 234ms
{
  "value": [...]
}`} language="text" showCopy={false} />
      </section>

      <section class="example">
        <div class="example-header">
          <h2>üìÅ Save & Format Responses</h2>
          <p>Control output format and save responses to files.</p>
        </div>

        <h3>Save to File</h3>
        <CodeBlock code={`azd rest get https://management.azure.com/subscriptions?api-version=2020-01-01 \\
  --output-file subscriptions.json`} language="bash" />

        <h3>Compact JSON</h3>
        <CodeBlock code={`azd rest get https://management.azure.com/subscriptions?api-version=2020-01-01 --format json`} language="bash" />

        <h3>Raw Output</h3>
        <CodeBlock code={`azd rest get https://api.example.com/data --format raw --no-auth`} language="bash" />

        <h3>Binary Download</h3>
        <CodeBlock code={`azd rest get https://example.com/image.png --binary --output-file image.png --no-auth`} language="bash" />
      </section>

      <section class="example">
        <div class="example-header">
          <h2>üîÑ Pagination & Retries</h2>
          <p>Handle large result sets and transient failures automatically.</p>
        </div>

        <h3>Auto Pagination</h3>
        <CodeBlock code={`# Follow nextLink headers to get all results
azd rest get https://management.azure.com/subscriptions/{sub}/resources?api-version=2021-04-01 --paginate`} language="bash" />

        <h3>Custom Retry Count</h3>
        <CodeBlock code={`# Retry up to 5 times on transient errors
azd rest get https://management.azure.com/subscriptions?api-version=2020-01-01 --retry 5`} language="bash" />

        <h3>Disable Retries</h3>
        <CodeBlock code={`azd rest get https://management.azure.com/subscriptions?api-version=2020-01-01 --retry 0`} language="bash" />
      </section>

      <section class="example">
        <div class="example-header">
          <h2>üåê Public APIs (No Auth)</h2>
          <p>Call non-Azure endpoints by disabling authentication.</p>
        </div>

        <CodeBlock code={`# GitHub API
azd rest get https://api.github.com/repos/Azure/azure-dev --no-auth

# Any public REST API
azd rest get https://jsonplaceholder.typicode.com/posts/1 --no-auth`} language="bash" />
      </section>

      <section class="section">
        <h2>More Resources</h2>
        <div class="resources">
          <a href={`${base}getting-started`} class="resource-card">
            <h3>üìö Getting Started</h3>
            <p>Install and set up azd rest</p>
          </a>
          <a href={`${base}reference`} class="resource-card">
            <h3>üìñ CLI Reference</h3>
            <p>Complete command and flag reference</p>
          </a>
        </div>
      </section>
    </div>
  </div>
</Layout>

<style>
  .page-container {
    max-width: 900px;
    margin: 0 auto;
    padding: 3rem 1.5rem;
  }

  .page-header {
    margin-bottom: 3rem;
  }

  .page-header h1 {
    font-size: 2.5rem;
    font-weight: 700;
    margin: 0 0 1rem;
    color: var(--color-text-primary);
  }

  .page-intro {
    font-size: 1.25rem;
    color: var(--color-text-secondary);
    margin: 0;
  }

  .content {
    line-height: 1.7;
  }

  .example {
    margin-bottom: 4rem;
    padding-bottom: 3rem;
    border-bottom: 1px solid var(--color-border-default);
  }

  .example:last-of-type {
    border-bottom: none;
  }

  .example-header {
    margin-bottom: 1.5rem;
  }

  .example-header h2 {
    font-size: 1.75rem;
    font-weight: 600;
    margin: 0 0 0.5rem;
    color: var(--color-text-primary);
  }

  .example-header p {
    font-size: 1.125rem;
    color: var(--color-text-secondary);
    margin: 0;
  }

  .example h3 {
    font-size: 1.125rem;
    font-weight: 600;
    margin: 2rem 0 0.5rem;
    color: var(--color-text-primary);
  }

  .example p {
    color: var(--color-text-secondary);
    margin: 0 0 1rem;
  }

  .section {
    margin-top: 4rem;
  }

  .section h2 {
    font-size: 1.75rem;
    font-weight: 600;
    margin: 0 0 1.5rem;
    color: var(--color-text-primary);
  }

  .resources {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
    gap: 1.5rem;
  }

  .resource-card {
    display: block;
    border: 1px solid var(--color-border-default);
    border-radius: 0.5rem;
    padding: 1.5rem;
    background-color: var(--color-bg-primary);
    text-decoration: none;
    transition: border-color 0.2s;
  }

  .resource-card:hover {
    border-color: var(--color-interactive-default);
    text-decoration: none;
  }

  .resource-card h3 {
    font-size: 1.125rem;
    margin: 0 0 0.5rem;
    color: var(--color-text-primary);
  }

  .resource-card p {
    margin: 0;
    font-size: 0.875rem;
    color: var(--color-text-secondary);
  }
</style>
