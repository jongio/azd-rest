---
import Layout from '../components/Layout.astro';
import CodeBlock from '../components/CodeBlock.astro';
import InstallTabs from '../components/InstallTabs.astro';

const base = import.meta.env.BASE_URL;
---

<Layout title="Getting Started" description="Step-by-step guide to install and use azd rest for authenticated Azure REST API calls">
  <div class="page-container">
    <div class="page-header">
      <h1>Getting Started</h1>
      <p class="page-intro">
        Follow these steps to install azd rest and make your first authenticated Azure REST API call.
      </p>
    </div>

    <div class="content">
      <section class="section">
        <h2>Prerequisites</h2>
        <p>Before installing azd rest, make sure you have:</p>
        <ul>
          <li><strong>Azure Developer CLI (azd)</strong> installed on your system</li>
          <li><strong>Azure subscription</strong> and appropriate permissions</li>
          <li><strong>Azure CLI login</strong> â€” run <code>az login</code> to authenticate</li>
        </ul>
        <p>If you don't have azd installed, visit the <a href="https://learn.microsoft.com/azure/developer/azure-developer-cli/install-azd" target="_blank" rel="noopener noreferrer">official installation guide</a>.</p>
      </section>

      <section class="section">
        <h2>Install azd rest</h2>
        <p>Install the azd rest extension using the following commands for your platform:</p>
        <InstallTabs />
      </section>

      <section class="section">
        <h2>Verify Installation</h2>
        <p>Confirm that azd rest is installed correctly:</p>
        <CodeBlock code={`azd rest version`} language="bash" />
        <p>You should see output similar to:</p>
        <CodeBlock code={`azd rest
Version: 0.1.0
Build Date: 2026-01-09T10:30:45Z
Git Commit: abc123def`} language="text" showCopy={false} />
      </section>

      <section class="section">
        <h2>Make Your First Request</h2>
        <p>List your Azure subscriptions â€” authentication is handled automatically:</p>

        <CodeBlock code={`azd rest get https://management.azure.com/subscriptions?api-version=2020-01-01`} language="bash" />

        <p>You should see a JSON response with your subscriptions:</p>
        <CodeBlock code={`{
  "value": [
    {
      "id": "/subscriptions/00000000-0000-0000-0000-000000000000",
      "subscriptionId": "00000000-0000-0000-0000-000000000000",
      "displayName": "My Subscription",
      "state": "Enabled"
    }
  ]
}`} language="json" showCopy={false} />
      </section>

      <section class="section">
        <h2>How Authentication Works</h2>
        <p>
          <code>azd rest</code> automatically detects the Azure service you're calling and applies the correct OAuth scope.
          It uses your Azure CLI credentials (via <code>az login</code>) to acquire tokens.
        </p>

        <h3>Automatic Scope Detection</h3>
        <p>No need to specify scopes for common Azure services:</p>
        <CodeBlock code={`# Management API â€” auto-detected
azd rest get https://management.azure.com/subscriptions?api-version=2020-01-01

# Key Vault â€” auto-detected
azd rest get https://myvault.vault.azure.net/secrets/mysecret?api-version=7.4

# Microsoft Graph â€” auto-detected
azd rest get https://graph.microsoft.com/v1.0/me`} language="bash" />

        <h3>Custom Scopes</h3>
        <p>For non-Azure endpoints, provide a scope manually:</p>
        <CodeBlock code={`azd rest get https://api.myservice.com/data --scope https://myservice.com/.default`} language="bash" />

        <h3>No Authentication</h3>
        <p>For public APIs that don't require auth:</p>
        <CodeBlock code={`azd rest get https://api.github.com/repos/Azure/azure-dev --no-auth`} language="bash" />
      </section>

      <section class="section">
        <h2>Common Commands</h2>

        <h3>GET Request</h3>
        <CodeBlock code={`azd rest get https://management.azure.com/subscriptions?api-version=2020-01-01`} language="bash" />

        <h3>POST with JSON Body</h3>
        <CodeBlock code={`azd rest post https://management.azure.com/subscriptions/{sub}/resourceGroups/{rg}/providers/Microsoft.Storage/storageAccounts/{name}?api-version=2021-04-01 \\
  --data '{"location":"eastus","kind":"StorageV2","sku":{"name":"Standard_LRS"}}'`} language="bash" />

        <h3>POST with Body from File</h3>
        <CodeBlock code={`azd rest post https://api.example.com/resource --data-file request.json`} language="bash" />

        <h3>Verbose Output</h3>
        <CodeBlock code={`azd rest get https://management.azure.com/subscriptions?api-version=2020-01-01 --verbose`} language="bash" />

        <h3>Save Response to File</h3>
        <CodeBlock code={`azd rest get https://management.azure.com/subscriptions?api-version=2020-01-01 \\
  --output-file subscriptions.json`} language="bash" />

        <h3>Custom Headers</h3>
        <CodeBlock code={`azd rest get https://api.example.com/resource \\
  --header "X-Custom-Header: value" \\
  --header "Accept: application/json"`} language="bash" />
      </section>

      <section class="section">
        <h2>Next Steps</h2>
        <div class="next-steps">
          <div class="next-step-card">
            <h3>ðŸ“š Explore Examples</h3>
            <p>See real-world usage examples for different Azure services.</p>
            <a href={`${base}examples`} class="card-link">View Examples â†’</a>
          </div>

          <div class="next-step-card">
            <h3>ðŸ“– CLI Reference</h3>
            <p>Learn about all commands, flags, and supported services.</p>
            <a href={`${base}reference`} class="card-link">Read Reference â†’</a>
          </div>
        </div>
      </section>
    </div>
  </div>
</Layout>

<style>
  .page-container {
    max-width: 900px;
    margin: 0 auto;
    padding: 3rem 1.5rem;
  }

  .page-header {
    margin-bottom: 3rem;
  }

  .page-header h1 {
    font-size: 2.5rem;
    font-weight: 700;
    margin: 0 0 1rem;
    color: var(--color-text-primary);
  }

  .page-intro {
    font-size: 1.25rem;
    color: var(--color-text-secondary);
    margin: 0;
  }

  .content {
    line-height: 1.7;
  }

  .section {
    margin-bottom: 3rem;
  }

  .section h2 {
    font-size: 1.75rem;
    font-weight: 600;
    margin: 0 0 1rem;
    color: var(--color-text-primary);
  }

  .section h3 {
    font-size: 1.25rem;
    font-weight: 600;
    margin: 2rem 0 1rem;
    color: var(--color-text-primary);
  }

  .section p {
    margin: 0 0 1rem;
    color: var(--color-text-secondary);
  }

  .section ul {
    margin: 0 0 1rem;
    padding-left: 1.5rem;
  }

  .section li {
    margin: 0.5rem 0;
    color: var(--color-text-secondary);
  }

  .section code {
    background-color: var(--color-bg-tertiary);
    padding: 0.125rem 0.375rem;
    border-radius: 0.25rem;
    font-size: 0.875em;
  }

  .next-steps {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
    gap: 1.5rem;
    margin-top: 2rem;
  }

  .next-step-card {
    border: 1px solid var(--color-border-default);
    border-radius: 0.5rem;
    padding: 1.5rem;
    background-color: var(--color-bg-primary);
  }

  .next-step-card h3 {
    font-size: 1.125rem;
    margin: 0 0 0.5rem;
    color: var(--color-text-primary);
  }

  .next-step-card p {
    margin: 0 0 1rem;
    font-size: 0.875rem;
  }

  .card-link {
    color: var(--color-interactive-default);
    font-weight: 600;
    text-decoration: none;
  }

  .card-link:hover {
    text-decoration: underline;
  }
</style>
